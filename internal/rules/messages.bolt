//
// messages.bolt
//

path /messages {
  read() { amAdmin() }
  /{msg} is Message;
}

type Message {
  from: FinalAuth
  to: String
  text: MessageText
  created: FinalNow
  create() {
    this.from != this.to
    && root.users[this.from].messages[this.to][key()] != null
    && root.users[this.to].messages[this.from][key()] != null
  }
}

type MessageText extends String {
  validate() { this.length >= 1 && this.length <= 500}
}
