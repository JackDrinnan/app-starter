<link rel="import" href="/bower_components/paper-material/paper-material.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-input/paper-textarea.html">
<link rel="import" href="/src/header.html">

<dom-module id="feedback-page">
  <template>
    <style include="app-styles">
      :host {
        display: block;
      }
      #input {
        margin: 24px 0;
      }
    </style>
    <paper-material>
      <div class="font-title">
        Feedback
      </div>
      <paper-textarea
        id="input"
        required
        char-counter
        label=""
        minlength="15"
        maxlength="1000">
      </paper-textarea>
      <paper-button disabled$="[[!auth]]" class="primary-button" raised on-tap="sendFeedback">Send</paper-button>
    </paper-material>
  </template>

  <script>
    class FeedbackPage extends Polymer.Element {
      static get is() { return 'feedback-page'; }
      static get config() {
        return { /* properties, observers meta data */
          properties: {
            auth: Object
          }
        }
      }
      constructor() {
        super();
      }
      connectedCallback() {
        super.connectedCallback();
      }
      sendFeedback() {
        var feedback = this.$.input.value;
        if (feedback && feedback.length >= 15 && feedback.length <= 1000) {
          db.users.sendFeedback(this.auth.name, feedback, function () {
            showSuccessToast('Feedback sent!');
          }, showServerErrorToast);
        } else {
          this.$.input.invalid = true;
        }
      }
    }
    // Register custom element definition using standard platform API
    customElements.define(FeedbackPage.is, FeedbackPage);
  </script>
</dom-module>
