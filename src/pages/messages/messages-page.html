<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/iron-collapse-button/iron-collapse-button.html">
<link rel="import" href="../../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../header.html">
<link rel="import" href="last-message.html">
<dom-module id="messages-page">
<template>
  <style include="app-styles">
    :host {
      display: block;
    }
    iron-list {
      height: calc(100vh - 296px);
      max-height: 400px;
    }
    iron-collapse-button {
      margin-top: 24px;
    }
    .list-item {
      padding: 16px 16px 8px 16px;
      margin: 6px 12px;
      border-radius: 6px;
    }
  </style>

  <paper-material>
    <div class="font-headline align-center">Messages</div>
  </paper-material>

    <iron-list
    id="list"
    scroll-target="document"
    items="[[_objectToArray(auth.user.messages)]]"
    as="user">
    <template>
      <div>
        <paper-material class="list-item">
          <div class="font-subhead">[[user.key]]</div>
          <last-message data="[[_lastMessage(auth, user.val)]]"></last-message>
        </paper-material>
      </div>
    </template>
  </iron-list>
</template>
<script>
Polymer({
  is: 'messages-page',
  properties: {

  },

  // TODO behavior
  _objectToArray: function(obj) {
    return objectToArray(obj);
  },

  _lastMessage: function(auth, chat) {
    return auth.user.chats[chat];
  },
  notifyResize: function() {
    this.$.list.notifyResize();
  },
});
</script>
</dom-module>
